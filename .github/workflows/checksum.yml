name: Main

on:
  push:
    tags:
      - "v*.*.*"
    paths:
      - "lib/sh/**"
      - "lib/zsh/**"
  workflow_dispatch: {}

jobs:
  release:
    name: Create release
    runs-on: ubuntu-latest
    steps:
      - name: Checkout sources
        uses: actions/checkout@v2
      - name: Download releaseartifacts
        uses: actions/download-artifact@v2
        with:
          name: release-artifacts
          path: lib
      - name: Generate checksum
        uses: jmgilman/actions-generate-checksum@57c13a1f01a90b2a8bb449ec29bc23728b96c1cd
        with:
          patterns: |
            lib/zsh/init.zsh
      - name: Create release
        uses: softprops/action-gh-release@v1
        with:
          files: |
            lib/zsh/checksum.txt
            lib/zsh/init.zsh
